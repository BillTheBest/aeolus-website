
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <title>Deltacloud - Documentation</title>



  <meta name="keywords" content="">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="shortcut icon" href="./styles/favicon.ico" type="image/x-icon">
  <link rel="StyleSheet" type="text/css" href="./styles/default.css" title="Main style">

  <link rel="Alternate StyleSheet" type="text/css" href="./styles/default-debug.css" title="Debug main style">

</head>


<body>
  <div id="header">
       <div class="container">
       <div id="headerLogo" style="cursor: pointer;" onclick="location.href='index.html';">
       <h1>Deltacloud - Many clouds. One API. No problem.</h1>
       </div>

       </div>
  </div>

    <div id="navigation">

    <div id="menu" class="container">
      <ul class="l0">
               <li><a class="inactive" title="Deltacloud Home" href="./index.html">Home</a></li>
               <li><a class="inactive" title="Tools" href="./tools.html">Tools</a></li>
               <li><a class="inactive" title="Get the latest releases" href="./download.html">Download</a></li>
               <li><a class="inactive" title="Information about design/development process" href="./contribute.html">Contribute</a></li>
               <li><a class="active" title="Project documentation" href="./documentation.html">Documentation</a></li>
               <li><a class="inactive" title="Project wiki" href="./page">Wiki</a></li>
         </ul>

    </div>
    </div>
       <div id ="subnavigation">
       <div id="submenu" class="container">

          <ul class="l1">
<li>
  <a class="inactive" href="documentation.html">Overview</a>
</li>
<li>
  <a class="active" href="api.html">REST API</a>
</li>
<li>
  <a class="inactive" href="client-ruby.html">Ruby Client</a>
</li>
<li>
  <a class="inactive" href="drivers.html">Drivers</a>
</li>
<li>
  <a class="inactive" href="framework.html">Framework</a>
</li>
</ul>

       </div>
       </div>

       <div id="main">
    <div id="content-deltacloud" class="container">
      <ul class="toc">
  <li><a href="#rest">REST</a>
  </li>
  <li><a href="#authentication">Authentication</a>
  </li>
  <li><a href="#primary_entry_point">Primary Entry Point</a>
  </li>
  <li><a href="#resources">Resources</a>
    <ul>
  <li><a href="#resources_flavors">Flavors</a>
  <li><a href="#resources_realms">Realms</a>
  <li><a href="#resources_images">Images</a>
  <li><a href="#resources_instances">Instances</a>
    </ul>
  </li>
</ul>
<h1>Deltacloud API</h1>

<p>The Deltacloud API is built as a service-based REST API.
You do not directly link a Deltacloud library into your
program to use it. Instead, a client speaks the Deltacloud
API over HTTP to a server which implements the REST interface.</p>

<p>Of course, at this point in time, no cloud provider
natively speaks the Deltacloud API. To accomodate
the native APIs used by the various cloud providers,
the Deltacloud project also provides a <em>framework</em>
and a set of <em>drivers</em> that work with the framework.</p>

<p>By running a framework &amp; driver combination on some
host, your application can use the Deltacloud API,
and the driver is responsible for translating these
calls into each provider's own API.</p>

<h2><a name="rest">REST</a></h2>

<p>The Deltacloud API is a RESTful API, using HATEOAS
architectural style. The API requires no client-side
URL construction.  Access is based entirely off a
single entry-point resource.  This allows other implementors
to structure their URL space however they like.</p>

<p>Additionally, the Deltacloud API uses <em>content negotiation</em>
to determine the format of the returned representation. As
of the current revision, the only required representation is
XML.  Clients wishing to receive XML representations must
specify the HTTP <code>Accept</code> header as <code>text/xml</code>.</p>

<h2><a name="authentication">Authentication</a></h2>

<p>The Deltacloud API uses HTTP authentication methods for
authenticating a given client.  There is no explicit
<em>login</em> action required.  If authentication is required,
an HTTP status of 401 will be returned to challenge
for credentials.</p>

<h2><a name="primary_entry_point">Primary Entry Point</a></h2>

<p>Any Deltacloud implementor <em>must</em> provide exactly
one well-known URL as an entry-point. For example,
<code>http://fancycloudprovider.com/api</code>.</p>

<p>The result of this entry-point is a set of entry-points
into other collections, such as <em>images</em>, <em>instances</em>,
<em>flavors</em> and <em>realms</em>, among others.</p>

<p>Each collection is defined by a <code>&lt;link&gt;</code> tag with an
<code>href</code> attribute which includes the fully-qualified URL
to the collection (which <em>may</em> exist on different servers)
and a <code>rel</code> attribute to denote which collection is being
specified.</p>

<pre><code>&lt;api driver='ec2' version='1.0'&gt;
  &lt;link href='http://fancycloudprovider.com/api/flavors' rel='flavors' /&gt;
  &lt;link href='http://fancycloudprovider.com/api/instance-states' rel='instance_states' /&gt;
  &lt;link href='http://fancycloudprovider.com/api/realms' rel='realms' /&gt;
  &lt;link href='http://fancycloudprovider.com/api/images' rel='images' /&gt;
  &lt;link href='http://fancycloudprovider.com/api/instances' rel='instances' /&gt;
&lt;/api&gt;
</code></pre>

<h2><a name="resources">Resources</a></h2>

<p>From the primary entry-point, a client may follow the URL provided for
a collection to retrieve the resources within that collection.  The collection
representation will include the full representations of the items within it,
along with links to retrieve each item individually.</p>

<p><img src="styles/basic-relationships.png" alt="Basic relationships" /></p>

<h3><a name="resources_flavors">Flavors</a></h3>

<p>Within a cloud provider a <em>flavor</em> represents a configuration of resources upon
which a machine may be deployed. A flavor defines aspects such as local disk storage,
available RAM, and architecture.  A future revision of the Deltacloud API will
include more aspects, including number and speed of CPUs available.  Each provider
is free to define as many (or as few) flavors as desired.</p>

<pre><code>&lt;flavors&gt;
  &lt;flavor href="http://fancycloudprovider.com/api/flavors/m1-small"&gt;
    &lt;id&gt;m1-small&lt;/id&gt;
    &lt;architecture&gt;i386&lt;/architecture&gt;
    &lt;memory&gt;1.7&lt;/memory&gt;
    &lt;storage&gt;160&lt;/storage&gt;
  &lt;/flavor&gt;
  &lt;flavor href="http://fancycloudprovider.com/api/flavors/m1-large"&gt;
    &lt;id&gt;m1-large&lt;/id&gt;
    &lt;architecture&gt;x86_64&lt;/architecture&gt;
    &lt;memory&gt;7.5&lt;/memory&gt;
    &lt;storage&gt;850&lt;/storage&gt;
  &lt;/flavor&gt;
&lt;/flavors&gt;
</code></pre>

<p>Each <code>&lt;flavor&gt;</code> block shall contain an <code>href</code> attribute providing a URL to manipulate a
specific flavor, along with elements for each attribute of a flavor. </p>

<ul>
<li><strong><code>id</code></strong>            A unique identifier for the flavor</li>
<li><strong><code>architecture</code></strong>  The architecture
<ul>
<li>i386</li>
<li>x86_64</li>
</ul></li>
<li><strong><code>memory</code></strong>        The amount of RAM, in gigabytes.</li>
<li><strong><code>storage</code></strong>       The amount of local disk storage, in gigabytes.</li>
</ul>

<p>At this time, flavor resources are immutable and read-only.  In a future revision
they may be mutable.</p>

<h3><a name="resources_realms">Realms</a></h3>

<p>Within a cloud provider a <em>realm</em> represents a boundary containing resources. The
exact definition of a realm is left to the cloud provider.  In some cases, a realm
may represent different datacenters, different continents, or different pools of
resources within a single datacenter. A cloud provider may insist that resources
must all exist within a single realm in order to cooperate.  For instance, storage
volumes may only be allowed to be mounted to instances within the same realm.  </p>

<pre><code>&lt;realms&gt;
  &lt;realm href="http://fancycloudprovider.com/api/realms/us"&gt;
    &lt;id&gt;us&lt;/id&gt;
    &lt;name&gt;United States&lt;/name&gt;
    &lt;state&gt;AVAILABLE&lt;/state&gt;
    &lt;limit/&gt;
  &lt;/realm&gt;
  &lt;realm href="http://fancycloudprovider.com/api/realms/eu"&gt;
    &lt;id&gt;eu&lt;/id&gt;
    &lt;name&gt;Europe&lt;/name&gt;
    &lt;state&gt;AVAILABLE&lt;/state&gt;
    &lt;limit/&gt;
  &lt;/realm&gt;
&lt;/realms&gt;
</code></pre>

<p>Each <code>&lt;realm&gt;</code> block shall contain an <code>href</code> attribute providing a URL to manipulate a
specific realm, along with elements for each attribute of a realm.</p>

<ul>
<li><strong><code>id</code></strong>          A unique identifier for the realm</li>
<li><strong><code>name</code></strong>        A short label</li>
<li><strong><code>state</code></strong>       Indicator of the current state of a realm
<ul>
<li>AVAILABLE</li>
<li>UNAVAILABLE</li>
</ul></li>
<li><strong><code>limit</code></strong>       Limits applicable for the <em>current requester</em></li>
</ul>

<h3><a name="resources_images">Images</a></h3>

<p>An <em>image</em> is a platonic form of a machine. Images are not directly
executable, but are a template for creating actual instances of
machines.</p>

<p>The instances collection will return a set of all images available to
the current user.</p>

<pre><code>&lt;images&gt;
  &lt;image href="http://fancycloudprovider.com/api/images/img1"&gt;
    &lt;id&gt;img1&lt;/id&gt;
    &lt;owner_id&gt;fedoraproject&lt;/owner_id&gt;
    &lt;name&gt;&lt;/name&gt;
    &lt;description&gt;Fedora 10&lt;/description&gt;
    &lt;architecture&gt;x86_64&lt;/architecture&gt;
  &lt;/image&gt;
  &lt;image href="http://fancycloudprovider.com/api/images/img2"&gt;
    &lt;id&gt;img2&lt;/id&gt;
    &lt;owner_id&gt;fedoraproject&lt;/owner_id&gt;
    &lt;name&gt;&lt;/name&gt;
    &lt;description&gt;Fedora 10&lt;/description&gt;
    &lt;architecture&gt;i386&lt;/architecture&gt;
  &lt;/image&gt;
  &lt;image href="http://fancycloudprovider.com/api/images/img3"&gt;
    &lt;id&gt;img3&lt;/id&gt;
    &lt;owner_id&gt;ted&lt;/owner_id&gt;
    &lt;name&gt;&lt;/name&gt;
    &lt;description&gt;JBoss&lt;/description&gt;
    &lt;architecture&gt;i386&lt;/architecture&gt;
  &lt;/image&gt;
&lt;/images&gt;
</code></pre>

<p>Each <code>&lt;image&gt;</code> block <em>shall</em> contain an <code>href</code> attribute providing
a URL to manipulate a specific image, along with elements for each
attribute of an image.  Each element, including those for optional
attributes must be present.  Optional attributes may be specified
as a element with empty content.</p>

<p>These attributes include</p>

<ul>
<li><strong><code>id</code></strong>            A unique identifier for the image</li>
<li><strong><code>owner_id</code></strong>      An opaque identifier which indicates the owner of an image</li>
<li><strong><code>name</code></strong>          An <em>optional</em> short label describing the image</li>
<li><strong><code>description</code></strong>   An <em>optional</em> description describing the image more fully</li>
<li><strong><code>architecture</code></strong>  A description of the machine architecture of the image
which may contain values such as:
<ul>
<li><code>i386</code></li>
<li><code>x86_64</code></li>
</ul></li>
</ul>

<p>At this time, image resources are immutable and read-only.  In a future revision
they will be mutable.</p>

<h3><a name="resources_instances">Instances</a></h3>

<p>An <em>instance</em> is a concrete machine realized from an <em>image</em>.  The images
collection may be obtained by following the link from the primary entry-point.</p>

<pre><code>&lt;instances&gt;
  &lt;instance href="http://fancycloudprovider.com/api/instances/inst1"&gt;
    &lt;id&gt;inst1&lt;/id&gt;
    &lt;owner_id&gt;larry&lt;/owner_id&gt;
    &lt;name&gt;Production JBoss Instance&lt;/name&gt;
    &lt;image href="http://fancycloudprovider.com/api/images/img3"/&gt;
    &lt;flavor href="http://fancycloudprovider.com/api/flavors/m1-small"/&gt;
    &lt;realm href="http://fancycloudprovider.com/api/realms/us"/&gt;

    &lt;state&gt;RUNNING&lt;/state&gt;
    &lt;actions&gt;
      &lt;link rel="reboot" href="http://fancycloudprovider.com/api/instances/inst1/reboot"/&gt;
      &lt;link rel="stop" href="http://fancycloudprovider.com/api/instances/inst1/stop"/&gt;
    &lt;/actions&gt;
    &lt;public-addresses&gt;
      &lt;address&gt;inst1.larry.fancycloudprovider.com&lt;/address&gt;
    &lt;/public-addresses&gt;

    &lt;private-addresses&gt;
      &lt;address&gt;inst1.larry.internal&lt;/address&gt;
    &lt;/private-addresses&gt;
  &lt;/instance&gt;
&lt;/instances&gt;
</code></pre>

<p>Each <code>&lt;instance&gt;</code> block shall contain an href attribute providing a URL to manipulate a
specific instance, along with elements for each attribute of an instance. Each element,
including those for optional attributes must be present. Optional attributes may be
specified as a element with empty content.</p>

<p>Simple attributes include</p>

<ul>
<li><strong><code>id</code></strong>           A unique identifier for the instance</li>
<li><strong><code>owner_id</code></strong>     An opaque identifier which indicates the owner of an instance</li>
<li><strong><code>name</code></strong>         An <em>optional</em> short label describing the instance</li>
<li><strong><code>image</code></strong>        Provides a link to the platonic image from which the instance is based</li>
<li><strong><code>flavor</code></strong>       Provides a link to flavor of virtual hardware in use by the instance </li>
<li><strong><code>realm</code></strong>        Provides a link to the realm where the instance is deployed</li>
<li><strong><code>state</code></strong>        Indicator of the instance's current state
<ul>
<li><code>PENDING</code></li>
<li><code>STOPPED</code></li>
<li><code>RUNNING</code></li>
</ul></li>
</ul>

<p>Multiple-valued attributes include</p>

<ul>
<li><strong><code>public-addresses</code></strong>  Publicly routable IP addresses or names for the instance</li>
<li><strong><code>private-addresses</code></strong>  Private network IP addresses or names for the instance</li>
</ul>

<p>In addition to the abovementioned attributes, each <code>&lt;instance&gt;</code> may contain an
<code>&lt;actions&gt;</code> block specifying valid actions for the instance, along with the URL
which may be used to perform the action.  Each action is specified by a <code>&lt;link&gt;</code>
with an <code>href</code> attribute providing the URL, and a <code>rel</code> attribute providing
a key to determine what the action will do.</p>

<p>Representative actions include</p>

<ul>
<li><code>reboot</code></li>
<li><code>start</code></li>
<li><code>stop</code></li>
</ul>

<p>Not all actions may be valid at all times for all instances.  To invoke an
action, a client must perform an HTTP <code>POST</code> to the URL indicated.</p>

<h4>Creating a new Instance</h4>

<p>Per usual REST architectural style, new instances are created by issuing
an HTTP <code>POST</code> to the instances collection as defined through the
primary entry-point URL. Data should be sent in <code>application/x-www-form-urlencoded</code>
format.</p>

<p>To create a new instance, only one parameter is required</p>

<ul>
<li><strong><code>image_id</code></strong>   The identifier (not URL) of the image from which to base the instance</li>
</ul>

<p>Optional parameters may also be provided</p>

<ul>
<li><strong><code>realm_id</code></strong>   The realm in which to launch the instance</li>
<li><strong><code>flavor_id</code></strong>  The machine flavor upon which to launch the instance</li>
<li><strong><code>name</code></strong>       A short label to identify the instance</li>
</ul>

<p>If <code>realm_id</code> or <code>flavor_id</code> are not specified, the provider <em>must</em> select
reasonable defaults.  The architecture of the selected flavor <em>must</em> match the
architecture of the specified image.</p>

<p>After <code>POST</code>ing the data, the server <em>shall</em> return a representation of
the newly-created instance's XML, including a URL to retrieve the instance
in the future.</p>

    </div>
  </div>

  <div id="footer-deltacloud">
    <div id="projects" class="container">
       <p id="et">
      <a href="http://et.redhat.com/"><img src="./styles/et_logo.png" alt="A Red Hat Emerging Technology Project"></a>

    </p>
      <dl id="p1">
        <dt><a href="http://augeas.net/">Augeas</a></dt>

        <dd><span>A configuration editing tool and API</span></dd>
        <dt><a href="http://libvirt.org/">libvirt</a></dt>
        <dd><span>The open source virtualization API</span></dd>
      </dl>

      <dl id="p2">
        <dt><a href="http://cobbler.et.redhat.com/">Cobbler</a></dt>

        <dd>OS provisioning and profile management</dd>
        <dt><a href="http://libguestfs.org/">virt-v2v</a></dt>
        <dd><span>Migrate guests from one hypervisor to another</span></dd>
      </dl>
      <dl id="p3">

        <dt><a href="http://freeipa.org/">FreeIPA</a></dt>

        <dd><span>Identity, policy and audit management</span></dd>
        <dt><a href="http://virt-manager.org/">Virtual Machine Manager</a></dt>
        <dd><span>Virtualization management from the desktop</span></dd>
      </dl>

       </div>

    </div>

</body>
</html>
